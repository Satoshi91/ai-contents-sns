# Twitter Clone 開発プロジェクト - Claude Code ガイドライン

## プロジェクト概要
Next.js + Firebase を使用したTwitterクローンアプリケーションの開発

## 開発プロセス・役割分担

### 役割定義
- **ユーザー（プロダクトオーナー）**
  - 要件定義・仕様策定
  - システム企画・機能優先順位決定
  - 結合テスト・受け入れテスト
  - UI/UX の最終確認

- **Claude Code（開発者）**
  - 詳細設計・技術選定
  - コード実装・単体テスト
  - ドキュメント整備
  - 技術的課題の解決

## 作業管理ルール

### WBS.mdでのタスク管理
1. **作業着手前**: 必ずWBS.mdにタスクを追加・更新
2. **作業単位**: 1つのタスクは1-2時間以内で完了可能な粒度
3. **ステータス管理**: ⬜未着手 → 🟦作業中 → ✅完了
4. **作業完了後**: WBS.mdの進捗を更新

### 段階的開発プロセス
1. **計画フェーズ**
   - WBS.mdでタスク整理
   - 技術仕様の確認
   - 依存関係の整理

2. **実装フェーズ**
   - 小単位での機能実装
   - 各機能完了時点での動作確認
   - エラーハンドリングの実装

3. **確認フェーズ**
   - ユーザーへの確認項目提示
   - 動作検証・フィードバック収集
   - 修正対応

## コード品質基準

### 実装原則
- **可読性重視**: 変数名・関数名は意味が明確
- **型安全性**: TypeScript厳格モード対応
- **エラーハンドリング**: try-catch文での適切な例外処理
- **セキュリティ**: 入力値検証・XSS/CSRF対策

### ファイル構成規約
- `src/components/` - 再利用可能UIコンポーネント
- `src/lib/` - ビジネスロジック・ユーティリティ
- `src/types/` - TypeScript型定義
- `doc/` - プロジェクト文書

### UI/UXインタラクション共通仕様
すべてのクリック可能コンポーネント（ボタン、リンク、クリック可能エリア）には以下を適用：

1. **マウスカーソル指定**
   - `cursor-pointer` クラスを必須で適用
   - マウスオン時にカーソルが指マークに変化

2. **ハイライト効果**
   - ホバー時に視覚的フィードバックを提供
   - 色変化、透明度変化、スケール変化などを適用
   - `transition-*` クラスでスムーズなアニメーション

3. **適用例**
   ```tsx
   // ボタンの場合
   className="cursor-pointer hover:bg-blue-600 transition-colors duration-200"
   
   // テキストリンクの場合  
   className="cursor-pointer hover:text-blue-600 transition-colors duration-200"
   
   // カード等の場合
   className="cursor-pointer hover:shadow-lg hover:scale-105 transition-all duration-200"
   ```

4. **適用対象**
   - Button コンポーネント
   - Link コンポーネント
   - クリックイベントを持つdiv, span等の要素
   - ナビゲーション要素
   - カード型コンポーネント

### アイコン付きボタンのレイアウト標準
アイコンとテキストを含むボタンコンポーネントでは、以下の標準パターンを使用：

1. **推奨パターン（標準）**
   ```tsx
   // 親要素に flex items-center space-x-* を適用
   <button className="flex items-center space-x-2 px-3 py-2 ...">
     <IconComponent size={16} />
     <span>テキスト</span>
   </button>
   ```

2. **注意事項**
   - アイコンコンポーネントには `mr-*` クラスを**付けない**
   - 親要素の `space-x-*` によってアイコンとテキストの間隔を制御
   - これにより改行問題や不要な余白を防ぐ

3. **避けるべきパターン**
   ```tsx
   // ❌ アイコンに直接 mr-* を適用（改行問題の原因）
   <button className="...">
     <IconComponent size={16} className="mr-2" />
     テキスト
   </button>
   ```

4. **使用場面**
   - ナビゲーションボタン
   - アクションボタン
   - モード切り替えボタン
   - フォーム送信ボタン

### コミット・更新ルール
- 機能単位でのコミット
- 分かりやすいコミットメッセージ
- WBS.md進捗の同期更新

## UI/UX 確認プロセス

### 画面修正時の確認事項
Claude Codeは画面確認ができないため、以下を徹底：

1. **実装完了時の確認項目明示**
   - 期待する表示内容
   - 操作手順
   - エラーケースの動作

2. **小単位での確認**
   - ボタン1つ、入力フィールド1つレベル
   - 個別機能の動作確認
   - 統合前の部分確認

3. **ブラウザ確認指示**
   - 具体的なURL
   - 確認すべき要素
   - 想定される動作

## バックエンド機能確認プロセス

### API・データ処理確認
1. **機能別単体テスト**
   - 正常系・異常系の動作確認
   - データベース操作の検証
   - 認証・認可の動作確認

2. **統合テスト前の確認**
   - フロントエンドとの連携確認
   - エラーレスポンスの適切性
   - パフォーマンス確認

## エラー対応・品質管理

### 問題発生時の対応フロー
1. **エラー再現**
   - 具体的な操作手順の確認
   - エラーメッセージ・ログの収集
   - 環境情報の確認

2. **原因分析・修正**
   - 根本原因の特定
   - 最小限の修正範囲で対応
   - 関連機能への影響確認

3. **再テスト・確認**
   - 修正内容の動作確認
   - 回帰テストの実施
   - ドキュメント更新

## プロジェクト進行の原則

### 品質優先の開発
- **完璧より完成**: 動作する最小限の機能から開始
- **段階的改善**: フィードバックを受けて継続的改善
- **可用性重視**: 常に動作する状態を維持

### コミュニケーション
- **透明性**: 進捗・課題を明確に報告
- **確認の徹底**: 曖昧な部分は必ず確認
- **学習姿勢**: フィードバックを積極的に活用

---

## 技術スタック情報
- **フロントエンド**: Next.js 15, React 19, TypeScript, Tailwind CSS
- **バックエンド**: Firebase (Auth, Firestore, Storage)
- **開発ツール**: ESLint, Prettier
- **ホスティング**: Firebase App Hosting

このガイドラインに従って、品質の高いソフトウェア開発を進めていきます。

---

## AIチャット機能実装方針

### 実装アプローチ
- **細かいタスク単位での確実な進行**: 1つのタスクは1-2時間以内で完了可能な粒度
- **段階的な動作確認**: 各機能完了時点で必ず動作確認を実施
- **じっくりとした進捗報告**: トークンを十分に使い、詳細な進捗を報告
- **プロダクトオーナーとの密な連携**: 不明点や仕様確認は逐次実施

### 実装フェーズ計画
**Phase 1: MVP実装（1-2週間）**
- Vercel AI SDKの導入
- shadcn/uiコンポーネントの追加
- モードセレクタの実装
- 基本的なチャット機能の実装
- APIルートの設定

**Phase 2: モード別機能実装（2-3週間）**
- 通常モードの完成
- ロールプレイモード（キャラクター設定UI、音声保存機能）
- キャンバスモード（デュアルペインUI、スクリプト保存機能）
- プロンプトテンプレート機能

**Phase 3: コンテンツ管理機能（2-3週間）**
- SSML編集支援
- バージョン管理システム
- 会話履歴の保存と検索
- エラーハンドリング
- レスポンシブ対応

### 動作確認が必要なポイント
1. **Vercel AI SDK導入後**: 基本的なストリーミング動作確認
2. **モードセレクタ実装後**: UI/UXの確認、モード切り替え動作
3. **各モード実装後**: モード別の機能動作確認
4. **コンテンツ保存機能実装後**: データの永続化確認
5. **統合機能実装後**: 既存システムとの連携確認

### 確認・相談が必要な事項
- APIキーの管理方法（OpenAI, Anthropic等）
- Cloudflare R2・Imagesの設定状況
- 既存Worksシステムとの統合方式
- ユーザー体験に関する仕様詳細
- セキュリティ・プライバシー要件